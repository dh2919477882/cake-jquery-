<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
     div.container{
	     width:1900px;
		 height:980px;
		 background:rgba(256,0,0,.1);
		 position:relative;
	 }
	 canvas#c3{
	   background: lightblue;
	   position:absolute;
	   top:50%;
	   left:50%;
	   margin-left:-400px;
	   margin-top:-300px;
	 }
	 div.container span{
	   position:absolute;
	   font-size:28px;
	   top:100px;
	   right:200px;
	   border:1px solid black;
	   border-radius:30%;
	 }
  </style>
  <script src="js/commonFunctions.js"></script>
 </head>
 <body>
  <div class="container">
      <span>×</span>
      <canvas id="c3" width="800px" height="600px"></canvas>
  </div>

 </body>
   <script>
    function rn(min,max){
	   var n=Math.random()*(max-min)+min
	   return Math.floor(n)
	}
	function rc(min,max){
	   var r=rn(min,max)
	   var g=rn(min,max)
	   var b=rn(min,max)
	   return `rgb(${r},${g},${b})`
	}
    var  c3=document.getElementById("c3")
	var  ctx=c3.getContext("2d")
	     ctx.beginPath()
	     ctx.moveTo(100,520)
		 ctx.lineTo(150,460)
		 ctx.lineTo(750,460)
		 ctx.lineTo(700,520)
		 ctx.closePath()
		 ctx.fillStyle="#b4b4b4"
		 ctx.fill()
		 ctx.beginPath();
		 ctx.moveTo(100,520)
         ctx.lineTo(100,600)
		 ctx.lineTo(700,600)
		 ctx.lineTo(750,550)
         ctx.lineTo(750,460)
         ctx.lineTo(700,520)
		 ctx.closePath()
         ctx.fillStyle="#ffcc33"
		 ctx.fill()
  setInterval(function(){
	  var str="更多惊喜等你来拿"
         ctx.textBaseline="top"
		 ctx.font="56px 华文行楷"
		 ctx.fillStyle=rc(100,256)
		ctx.fillText(str,200,50)
		 },1000)
          

	  var cakeObj=function(){
	       this.x=[]   //图片的位置
		   this.y=[]
		   this.show=[]  //图片的状态
		   this.list=[]  //图片的种类
		   this.spd=[]   //图片移动速度
		   this.l=[]     //图片长度
	  } 
     var cake=new cakeObj()
	  cakeObj.prototype.num=18;
	  cakeObj.prototype.init=function(){
	       for(var i=0;i<this.num;i++){
		      this.show[i]=false;
			  this.x[i]=0
			  this.y[i]=0
			  this.l[i]=0
			  this.spd[i]=Math.random()*0.1+0.003
			  this.list[i]=new Image()
			  this.list[i].src=`img/adv/sm-${i+4}-1.jpg`
			  console.log(this.list[i])
		   }
	  }
	  cakeObj.prototype.draw=function(){
		  console.log(1)
	     for(var i=0;i<this.num;i++){
		    if(this.show[i]){
				console.log(2)
			   if(this.l[i]<169){
			      this.l[i]+=1
				  this.y[i]-=this.spd[i]*2
			   }
			   console.log(this.list[i])
			   ctx.drawImage(this.list[i],this.x[i],this.y[i],this.l[i],this.l[i])
			   console.log("img.i:"+i)
                 console.log("this.x:"+this.x[i])
				 console.log("this.y:"+this.y[i])
				 console.log("this.l:"+this.l[i])
			   if(this.y[i]<100){
			      this.alive[i]=false
			   }
			}
		 }
	  }

	  function alive(){
		  console.log(3)
	     var sum=0
		 for(var i=0;i<cake.num;i++){
			 console.log(7)
		    if(cake.show[i]){
				 console.log(8)
				sum++
				console.log("sum"+sum) 
				}
		 
		 if(sum<9){
			 console.log(9)
		    send()
		 }
		 }
	  }
	  function send(){
		  console.log(4)
	      for(var i=0;i<cake.num;i++){
			  console.log(10)
			  console.log("i:"+i)
		     if(cake.show[i]===false){
				 console.log(6)
			    cake.born(i)
				return
			 }
		  }
	  }

	  cakeObj.prototype.born=function(i){
		  console.log(5)
	     var i=Math.floor(Math.random()*18)
		 this.x[i]=rn(150,675)
		 this.y[i]=460,
		 this.l[i]=50
		  this.spd[i]=0
		 this.show[i]=true
	  }
	  document.body.onload=game
	  function game(){
		  requestAnimFrame(game);
	     cake.init()
		 alive()
		 cake.draw()
	  }
	c.setAttribute()
  </script>
</html>
 